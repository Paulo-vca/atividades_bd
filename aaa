-- 1)
--SELECT * FROM cesta


--2)
-- SELECT id, nome, quant_minima, unidade_medida 
-- FROM Produto
-- ORDER BY quant_minima DESC


--3)
-- SELECT Cesta.codigo, Cesta.nome, Produto_cesta.quantidade, Produto.unidade_medida, Produto.nome
-- FROM Produto_cesta 
-- JOIN Produto ON Produto.id = Produto_cesta.produto_id
-- JOIN Cesta ON Cesta.codigo = Produto_cesta.cesta_codigo 
-- ORDER BY Cesta.codigo DESC, Produto.nome


--4)
-- SELECT Produto.id, Produto.nome, Mercado.nome, Produto.quant_minima, Pesquisa.preco, Produto.quant_minima*Pesquisa.preco AS "preco_total"
-- FROM Pesquisa 
-- JOIN Produto ON Produto.id = Pesquisa.produto_id
-- JOIN Mercado ON Mercado.id = Pesquisa.mercado_id
-- ORDER BY Produto.nome, Preco


--5)
-- SELECT Mercado.nome, Produto.id, Produto.nome, Produto.unidade_medida, Produto.quant_minima, Pesquisa.preco, Produto.quant_minima*Pesquisa.preco AS "preco_total"
-- FROM Pesquisa 
-- JOIN Produto ON Produto.id = Pesquisa.produto_id
-- JOIN Mercado ON Mercado.id = Pesquisa.mercado_id
-- WHERE Mercado.nome = 'Quitanda do Zé'
-- ORDER BY Produto.quant_minima*Pesquisa.preco DESC


--6)
SELECT Cesta.nome, Produto.nome, Mercado.nome, Produto_cesta.quantidade, Pesquisa.preco, Produto_cesta.quantidade*Pesquisa.preco AS "preco_total"
FROM Pesquisa 
JOIN Produto ON Pesquisa.produto_id = Produto.id
JOIN Mercado ON Pesquisa.mercado_id = Mercado.id
JOIN Cesta ON Produto_cesta.cesta_codigo = Cesta.codigo
JOIN Produto_cesta ON Produto.produto_id = Produto_cesta.id



-- FROM Produto_cesta 
-- JOIN Cesta ON Produto_cesta.cesta_codigo = Cesta.codigo
-- JOIN Produto ON Produto_cesta.produto_id = Produto.id
-- JOIN Pesquisa ON Produto_cesta.produto_id = Pesquisa.id
-- JOIN Mercado ON Pesquisa.mercado_id = Mercado.id

??????nao esta pronto o 6

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
Exercicio em sala


Select codigo,nome_cidade,nome_pais,idioma.nome
from cidade 
JOIN pais ON pais_id = id
JOIN idioma ON idioma_principal = sigla	
where turistica = true
order by nome_pais desc,nome_cidade


23/09

-- Select codigo,nome_cidade,nome_pais,idioma.nome
-- from cidade 
-- JOIN pais ON pais_id = id
-- JOIN idioma ON idioma_principal = sigla	
-- where turistica = true
-- order by nome_pais desc,nome_cidade


-- SELECT funcionario.pessoa_id, nome, sexo, cidade.nome_cidade
-- FROM pessoa
-- JOIN cidade ON cidade_codigo = codigo
-- JOIN funcionario ON pessoa.id = pessoa_id
-- WHERE nome_cidade ILIKE 'campinas%' AND sexo = 'F'
-- ORDER BY nome


-- SELECT *
-- FROM Pessoa JOIN Cidade ON Pessoa.cidade_codigo = Cidade.codigo
-- 	JOIN Funcionario ON Funcionario.pessoa_id = Pessoa.id
-- 	JOIN Piloto ON Piloto.pessoa_id = Funcionario.pessoa_id
-- 	WHERE cidade.nome_cidade ilike 'são%'


-- SELECT COUNT(*) FROM fakenames


-- SELECT gender, COUNT (*)
-- FROM fakenames
-- GROUP BY gender


-- SELECT state, gender, COUNT (*)
-- FROM fakenames
-- GROUP BY state, gender
-- ORDER BY state DESC, gender


-- SELECT state, gender, max(age), min(age), COUNT(*),SUM(age),AVG(age), SUM(age) *1.0 / COUNT (*)
-- FROM fakenames
-- GROUP BY state, gender
-- ORDER BY AVG (age)


-- SELECT gender, bloodtype, COUNT(*)
-- FROM fakenames
-- GROUP BY gender, bloodtype
-- ORDER BY COUNT(*) DESC


-- SELECT givenname, age, CASE WHEN age >= 60 THEN 'IDOSO' ELSE 'JOVEM' END
-- FROM fakenames
-- ORDER BY givenname

-- SELECT givenname, age, 
-- 	CASE 
-- 	WHEN age >= 60 THEN 'IDOSO' 
-- 	WHEN age >= 40 THEN 'ADULTO' 
-- 	WHEN age >= 18 THEN 'JOVEM'
-- 	ELSE 'MENOR'
-- 	END
-- FROM fakenames
-- ORDER BY givenname


-- SELECT
-- 	CASE 
-- 	WHEN age >= 60 THEN 'IDOSO' 
-- 	WHEN age >= 40 THEN 'ADULTO' 
-- 	WHEN age >= 18 THEN 'JOVEM'
-- 	ELSE 'MENOR'
-- 	END,
-- 	COUNT(*)
-- FROM fakenames
-- GROUP BY 1
-- ORDER BY 2 DESC
--order by count(*) desc -- outro exemplo


-- SELECT
-- 	CASE 
-- 		WHEN age >= 60 THEN 'IDOSO' 
-- 		WHEN age >= 40 THEN 'ADULTO' 
-- 		WHEN age >= 18 THEN 'JOVEM'
-- 		ELSE 'MENOR'
-- 	END,
-- 	COUNT(*)
-- FROM fakenames
-- GROUP BY 
-- 	CASE 
-- 		WHEN age >= 60 THEN 'IDOSO' 
-- 		WHEN age >= 40 THEN 'ADULTO' 
-- 		WHEN age >= 18 THEN 'JOVEM'
-- 		ELSE 'MENOR'
-- 		END
-- ORDER BY 2 DESC


-- SELECT gender,
-- 	CASE 
-- 		WHEN age >= 60 THEN 'IDOSO' 
-- 		WHEN age >= 40 THEN 'ADULTO' 
-- 		WHEN age >= 18 THEN 'JOVEM'
-- 		ELSE 'MENOR'
-- 	END,
-- 	COUNT(*)
-- FROM fakenames
-- GROUP BY 1,2
-- ORDER BY 1,2 





